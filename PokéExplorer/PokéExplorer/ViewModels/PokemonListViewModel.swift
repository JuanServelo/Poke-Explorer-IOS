////  PokemonListViewModel.swift//  PokéExplorer////  Created by user276508 on 14/06/25.//import Foundation@MainActorclass PokemonListViewModel: ObservableObject {    @Published var pokemons: [Pokemon] = []    @Published var isLoading = false        private let api = PokeAPIService()    private var offset = 0    private let limit = 20 // Define o tamanho de cada página    private var canLoadMorePages = true // Flag para controlar se ainda há dados a buscar    func fetchPokemons() {        // Garante que a busca inicial só aconteça uma vez        guard pokemons.isEmpty else { return }        loadMorePokemons()    }        func loadMorePokemons() {        // Impede múltiplas chamadas simultâneas ou chamadas desnecessárias        guard !isLoading, canLoadMorePages else {            return        }                isLoading = true                api.fetchPokemonList(limit: limit, offset: offset) { [weak self] result in            DispatchQueue.main.async {                guard let self = self else { return }                                switch result {                case .success(let newPokemons):                    // Adiciona os novos pokémons à lista existente                    self.pokemons.append(contentsOf: newPokemons)                    // Incrementa o offset para a próxima página                    self.offset += self.limit                    // Se a API retornou menos itens que o limite, não há mais páginas                    self.canLoadMorePages = newPokemons.count == self.limit                case .failure(let error):                    print("Erro ao buscar pokémons: \(error.localizedDescription)")                    // Em caso de erro, paramos de tentar carregar mais                    self.canLoadMorePages = false                }                                self.isLoading = false            }        }    }}